Пожалуйста, проанализируй код проекта по системе учета посещаемости. Вот основные детали проблемы:

Индивидуальный клик:
Ожидается, что при клике по ячейке статус будет переключаться по схеме:
пусто → галочка (PRESENT) → крестик (ABSENT) → пусто
Однако фактически наблюдается переключение:
пусто → крестик → галочка → пусто.
Массовое обновление (bulk update):
При выборе опции «Отметить всех» (с передачей статуса PRESENT) в ячейках отображается крестик, а при выборе «Отметить отсутствие» (с передачей статуса ABSENT) – ячейки становятся пустыми.
UI-рендеринг:
В компоненте AttendanceTable рендеринг иконок выглядит правильно:
Если статус равен AttendanceStatus.PRESENT, рендерится иконка галочки (Check).
Если статус равен AttendanceStatus.ABSENT, рендерится иконка крестика (X).
Enum AttendanceStatus определен корректно (NOT_MARKED, PRESENT, ABSENT).
Предположение:
Возможно, проблема кроется в том, что при массовом обновлении для каждого ученика вызывается функция, реализующая циклическое переключение статусов (например, логика в handleMarkAttendance), вместо прямого присвоения нужного статуса. Также возможно, что серверный эндпоинт (например, /api/attendance или /api/attendance/bulk) выполняет дополнительное переключение статуса.
Задачи для Replit агента:

Проверить логику массового обновления:
Убедиться, что функция handleBulkAttendance для bulk‑операции напрямую присваивает переданный статус (PRESENT или ABSENT) без циклического переключения.
Добавить отладочные сообщения (console.log) до и после вызова bulk‑операции, чтобы отследить, какой статус реально отправляется и сохраняется.
Проверить серверную логику:
Проанализировать эндпоинты, отвечающие за обновление посещаемости (/api/attendance и /api/attendance/bulk), и убедиться, что они не выполняют дополнительное переключение (toggle) статуса, а устанавливают его напрямую на основе переданного значения.
Разделить логику:
Предложить решение, при котором логика индивидуального переключения (циклический toggle) и массового обновления (прямое присвоение статуса) разделены, чтобы избежать конфликтов.
Пожалуйста, предоставь рекомендации и необходимые исправления для устранения этой проблемы.